WARNING:tensorflow:From nmt/utils/iterator_utils.py:235: group_by_window (from tensorflow.contrib.data.python.ops.grouping) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.group_by_window(...)`.
WARNING:tensorflow:From nmt/model_helper.py:402: __init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is deprecated, please use tf.nn.rnn_cell.LSTMCell, which supports all the feature this cell currently has. Please replace the existing code with tf.nn.rnn_cell.LSTMCell(name='basic_lstm_cell').
2019-11-29 08:02:07.283847: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:02:07.283863: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:02:07.283881: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.de is already initialized.
2019-11-29 08:09:37.681419: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:09:37.681470: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:09:37.681823: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.de is already initialized.
2019-11-29 08:09:37.849912: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:09:37.850002: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.de is already initialized.
2019-11-29 08:09:37.850309: I tensorflow/core/kernels/lookup_util.cc:376] Table trying to initialize from file /home/bcc/thcf16/tmp/iwslt15/vocab.en is already initialized.
2019-11-29 08:09:59.053964: W tensorflow/core/framework/op_kernel.cc:1273] OP_REQUIRES failed at matmul_op.cc:478 : Resource exhausted: OOM when allocating tensor with shape[6848,50000] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 707, in <module>
    tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 700, in main
    run_main(FLAGS, default_hparams, train_fn, inference_fn)
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 693, in run_main
    train_fn(hparams, target_session=target_session)
  File "nmt/train.py", line 577, in train
    eval_model, eval_sess, model_dir, hparams, summary_writer)
  File "nmt/train.py", line 113, in run_internal_eval
    summary_writer, "test")
  File "nmt/train.py", line 665, in _internal_eval
    ppl = model_helper.compute_perplexity(model, sess, label)
  File "nmt/model_helper.py", line 654, in compute_perplexity
    output_tuple = model.eval(sess)
  File "nmt/model.py", line 346, in eval
    return sess.run(output_tuple)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[6848,50000] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[node dynamic_seq2seq/decoder/output_projection/Tensordot/MatMul (defined at nmt/model.py:526)  = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device="/job:localhost/replica:0/task:0/device:CPU:0"](dynamic_seq2seq/decoder/output_projection/Tensordot/Reshape, dynamic_seq2seq/decoder/output_projection/kernel/read)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


Caused by op u'dynamic_seq2seq/decoder/output_projection/Tensordot/MatMul', defined at:
  File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 707, in <module>
    tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 700, in main
    run_main(FLAGS, default_hparams, train_fn, inference_fn)
  File "/nobackup/bcc/thcf16/nmt/nmt/nmt.py", line 693, in run_main
    train_fn(hparams, target_session=target_session)
  File "nmt/train.py", line 466, in train
    eval_model = model_helper.create_eval_model(model_creator, hparams, scope)
  File "nmt/model_helper.py", line 180, in create_eval_model
    extra_args=extra_args)
  File "nmt/attention_model.py", line 64, in __init__
    extra_args=extra_args)
  File "nmt/model.py", line 95, in __init__
    res = self.build_graph(hparams, scope=scope)
  File "nmt/model.py", line 393, in build_graph
    self._build_decoder(self.encoder_outputs, encoder_state, hparams))
  File "nmt/model.py", line 526, in _build_decoder
    logits = self.output_layer(outputs.rnn_output)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py", line 374, in __call__
    outputs = super(Layer, self).__call__(inputs, *args, **kwargs)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 757, in __call__
    outputs = self.call(inputs, *args, **kwargs)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/keras/layers/core.py", line 963, in call
    outputs = standard_ops.tensordot(inputs, self.kernel, [[rank - 1], [0]])
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 2985, in tensordot
    ab_matmul = matmul(a_reshape, b_reshape)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.py", line 2057, in matmul
    a, b, transpose_a=transpose_a, transpose_b=transpose_b, name=name)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.py", line 4560, in mat_mul
    name=name)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/util/deprecation.py", line 488, in new_func
    return func(*args, **kwargs)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 3274, in create_op
    op_def=op_def)
  File "/nobackup/bcc/thcf16/nmt/venv/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.py", line 1770, in __init__
    self._traceback = tf_stack.extract_stack()

ResourceExhaustedError (see above for traceback): OOM when allocating tensor with shape[6848,50000] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
	 [[node dynamic_seq2seq/decoder/output_projection/Tensordot/MatMul (defined at nmt/model.py:526)  = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device="/job:localhost/replica:0/task:0/device:CPU:0"](dynamic_seq2seq/decoder/output_projection/Tensordot/Reshape, dynamic_seq2seq/decoder/output_projection/kernel/read)]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.


er_mode=greedybeam_width=0, length_penalty=0.000000, coverage_penalty=0.000000
# Trainable variables
Format: <name>, <shape>, <(soft) device placement>
  embeddings/encoder/embedding_encoder:0, (50000, 32), /device:GPU:0
  embeddings/decoder/embedding_decoder:0, (50000, 32), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/encoder/rnn/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/decoder/memory_layer/kernel:0, (32, 32), 
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/kernel:0, (96, 128), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_0/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_1/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_2/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/kernel:0, (64, 128), /device:GPU:0
  dynamic_seq2seq/decoder/attention/multi_rnn_cell/cell_3/basic_lstm_cell/bias:0, (128,), /device:GPU:0
  dynamic_seq2seq/decoder/attention/luong_attention/attention_g:0, (), /device:GPU:0
  dynamic_seq2seq/decoder/attention/attention_layer/kernel:0, (64, 32), /device:GPU:0
  dynamic_seq2seq/decoder/output_projection/kernel:0, (32, 50000), 
# log_file=tmp/nmt_attention_model_DE_s20000_l4_u32/log_1575025301
  created train model with fresh parameters, time 0.29s
  created infer model with fresh parameters, time 0.14s
  # 2344
    src: Am vergangenen 4. November ging ein Lophoskopist des Ermittlungseinheit der Staatsanwaltschaft ( CTI ) aus Cali als der Mann , der die Identität des Anführers der FARC ( Fuerzas Armadas Revolucionarias de Colombia - Revolutionäre Streitkräfte Kolumbiens ) bestätigte , ein : &quot; Alfonso Cano &quot; durch Vergleich der Fingerabdrücke .
    ref: On November 4th the lophoscopist of Cali CTI passed into history as the man who confirmed the identity of the FARC top leader , &quot; Alfonso Cano , through the comparison of his fingerprints .
    nmt: apologized 10x 10x 10x 10x 10x 10x 10x alleviating 499 499 peeing peeing peeing Conventions Conventions Conventions discipline discipline discipline disposizione disposizione disposizione disposizione disposizione disposizione „ „ „ „ „ „ multilingualism sunniest ciudad ciudad ciudad ciudad ciudad ciudad ciudad stuffing shampoos shampoos vision vision vision vision vision vision vision vision 10x 10x 10x 10x 10x 10x 10x 10x 10x Altium Altium Altium MotoGP MotoGP MotoGP MotoGP MotoGP MotoGP Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana Pastrana childish childish childish
  created eval model with fresh parameters, time 0.15s
  eval dev: perplexity 50002.11, time 13s, Fri Nov 29 08:01:56 2019.
  eval test: perplexity 50002.08, time 10s, Fri Nov 29 08:02:07 2019.
  created infer model with fresh parameters, time 0.11s
# Start step 0, lr 1, Fri Nov 29 08:02:07 2019
# Init train iterator, skipping 0 elements
  step 100 lr 1 step-time 0.51s wps 6.03K ppl 39804.08 gN 51.66 bleu 0.00, Fri Nov 29 08:02:58 2019
  step 200 lr 1 step-time 0.45s wps 6.79K ppl 5685.68 gN 25.78 bleu 0.00, Fri Nov 29 08:03:43 2019
  step 300 lr 1 step-time 0.44s wps 6.93K ppl 3675.91 gN 20.84 bleu 0.00, Fri Nov 29 08:04:27 2019
  step 400 lr 1 step-time 0.45s wps 6.90K ppl 2745.28 gN 17.95 bleu 0.00, Fri Nov 29 08:05:12 2019
  step 500 lr 1 step-time 0.44s wps 6.92K ppl 2509.04 gN 16.79 bleu 0.00, Fri Nov 29 08:05:56 2019
  step 600 lr 1 step-time 0.44s wps 6.89K ppl 2102.01 gN 14.61 bleu 0.00, Fri Nov 29 08:06:40 2019
  step 700 lr 1 step-time 0.44s wps 6.93K ppl 2002.53 gN 13.72 bleu 0.00, Fri Nov 29 08:07:24 2019
  step 800 lr 1 step-time 0.44s wps 6.89K ppl 1814.36 gN 12.20 bleu 0.00, Fri Nov 29 08:08:08 2019
  step 900 lr 1 step-time 0.44s wps 6.91K ppl 1909.55 gN 14.72 bleu 0.00, Fri Nov 29 08:08:52 2019
  step 1000 lr 1 step-time 0.44s wps 6.89K ppl 1724.75 gN 12.02 bleu 0.00, Fri Nov 29 08:09:37 2019
# Save eval, global step 1000
  loaded infer model parameters from tmp/nmt_attention_model_DE_s20000_l4_u32/translate.ckpt-1000, time 0.09s
  # 18
    src: Nur - unser Lebensstil ist nun mal nicht der einzige und objektiv gesehen wohl auch nicht der beste und würde Abwechslung den erwähnten Libyern kaum passen .
    ref: However , our lifestyle is neither unique nor the best one and would not , most probably , be suitable for , for example , the people of Libya .
    nmt: The is , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,
  loaded eval model parameters from tmp/nmt_attention_model_DE_s20000_l4_u32/translate.ckpt-1000, time 0.09s
  eval dev: perplexity 1695.62, time 12s, Fri Nov 29 08:09:50 2019.
